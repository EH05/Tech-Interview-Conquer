<details>
  
<summary>
  <strong>크래시 일관성에 대해 설명하세요.</strong>
</summary>

<br>

  ### 크래시 일관성
  크래시 일관성은 시스템 크래시(전원 손실, 소프트웨어 오류 등)가 발생했을 때, 파일 시스템의 데이터와 메타데이터의 일관성을 보장하는 능력을 의미합니다.
  이 개념은 파일 시스템이 데이터를 디스크에 안전하게 기록하고, 예상치 못한 장애가 발생하더라도 데이터가 손상되지 않도록 설계되어야 한다는 필요성에서 비롯됩니다.

  #### 파일 시스템에서 크래시 일관성의 중요성
  파일 시스템은 디스크 상에 저장된 데이터와 메타데이터를 관리합니다. 이 과정에서 데이터는 일반적으로 메타데이터 갱신, 실제 데이터 쓰기를 거쳐 디스크에 기록됩니다.
  이 작업들이 완전히 이루어지기 전에 크래시가 발생하면 파일 시스템의 일부 데이터가 디스크에 기록되지 못한 상태가 되어 다음과 같은 문제가 발생할 수 있습니다.

  - **메타데이터와 데이터 불일치**: 비트맵과 아이노드가 가리키는 내용이 서로 다를 수 있습니다.
  - **공간 누수**: 특정 블록이 사용 중으로 표시되었지만, 이를 참조하는 데이터가 없는 경우가 발생합니다.
  - **사용자 데이터 손상**: 사용자는 의미 없는 데이터나 이전 데이터 값을 읽게 될 수 있습니다.

  #### 크래시 일관성 문제의 본질
  크래시 일관성 문제는 파일 시스템의 자료 구조들이 "연산 전 상태"와 "연산 후 상태" 사이의 중간 상태로 남아 있는 것을 방지하기 위한 것입니다.

  - 디스크가 한 번에 하나의 쓰기만 처리할 수 있으므로, 여러 쓰기 작업이 수행되는 중간에 크래시가 발생할 수 있습니다.
  - 이를 해결하지 않으면 파일 시스템의 일관성이 깨지고, 데이터 손실이나 공간 누수 등의 문제가 발생할 수 있습니다.

  #### 크래시 일관성을 유지하기 위한 해법
  - 저널링(Journaling)
  - 카피-온-라이트(Copy-on-Write)
  - 순차적 쓰기
  - 강제 동기화(Flush)

<br>
</details>

<details>
  
<summary>
  <strong>FSCK가 무엇이고 그 한계에 대해 설명하세요.</strong>
</summary>

<br>

  ### FSCK (File System Consistency Check)
  FSCK는 파일 시스템의 일관성을 검사하고 복구하는 도구입니다.
  크래시 이후 파일 시스템이 손상되었을 가능성이 있을 때, FSCK는 디스크 메타데이터를 점검하여 불일치를 수정합니다.
  이는 초기 파일 시스템에서 크래시 일관성을 유지하기 위해 널리 사용된 기법입니다.

  #### 주요 작업
  1. 슈퍼블럭 검사: 파일 시스템의 주요 정보를 담고 있는 슈퍼블럭의 상태를 확인하고, 문제가 발견되면 사본으로 교체합니다.
  2. 프리 블럭 검사: 아이노드와 블럭을 기반으로 할당 비트맵을 재구성하여 불일치를 해결합니다.
  3. 아이노드 상태 검사: 아이노드의 유효성을 확인하고, 손상된 아이노드는 초기화합니다.
  4. 아이노드 링크 검사: 아이노드의 링크 개수를 확인하고 불일치가 있으면 수정하거나, 고아 파일은 lost+found 디렉터리로 이동합니다.
  5. 중복 포인터 검사: 동일한 블럭을 가리키는 포인터를 탐지하고, 적절히 조치합니다.
  6. 배드 블럭 검사: 잘못된 포인터를 초기화하여 데이터 손상을 방지합니다.
  7. 디렉터리 검사: 디렉터리 구조를 점검하여 불일치와 연결 오류를 수정합니다.
    
  ### 한계
  #### 1. 속도의 한계
  - FSCK는 디스크 전체를 검사하며, 모든 블럭과 디렉터리를 읽고 점검합니다.
  - 대용량 디스크나 RAID 구성에서는 복구 작업이 몇 시간에서 며칠까지 걸릴 수 있습니다.
  - 이는 운영 환경에서 실질적으로 비효율적이며, 장시간의 서비스 중단을 초래합니다.
  
  #### 2. 사후 복구 중심
  - FSCK는 크래시 이후 파일 시스템의 일관성을 복구하는 도구로, 크래시 발생 전의 데이터 손실 방지에는 기여하지 못합니다.
  - 손상된 데이터나 메타데이터를 복구하지 못하는 경우도 있으며, 일부 데이터는 영구적으로 손실될 수 있습니다.
  
  #### 3. 불완전한 복구
  - FSCK는 파일 시스템의 메타데이터 불일치를 해결하는 데 초점이 맞춰져 있습니다.
  - 파일 시스템이 겉으로는 일관성 있어 보여도, 실제 데이터 무결성이나 의미적 일관성을 보장하지 못하는 경우가 발생할 수 있습니다.

  #### 4. 비용 대비 효율성 부족
  - 크래시로 인해 문제가 발생한 부분은 일부 블럭이나 메타데이터에 불과할 수 있습니다.
  - 그러나 FSCK는 이러한 문제를 해결하기 위해 전체 파일 시스템을 스캔하므로 과도한 자원 낭비가 발생합니다.
  
  #### 5. 사용 중단 필요 
  - FSCK는 파일 시스템이 마운트되지 않은 상태에서 실행되어야 합니다.
  - 이는 서버나 스토리지 시스템에서 사용자의 작업이 중단되는 다운타임을 초래합니다.

<br>
</details>

<details>
  
<summary>
  <strong>저널링에 대해 설명하세요.</strong>
</summary>

<br>

  ### 저널링 (Journaling)
  저널링은 데이터 손실이나 손상을 방지하기 위해, 데이터를 실제 저장소에 기록하기 전에 변경 사항을 먼저 로그에 기록하는 기술입니다.
  이 방식은 특히 파일 시스템에서 데이터 일관성을 유지하고 크래시 복구를 간소화하는 데 널리 사용됩니다.
  저널링의 원칙은 데이터 변경 작업을 두 단계로 나누어 처리하는 것입니다: 저널에 기록(write-ahead)하고, 이후 실제 위치에 데이터를 반영(checkpointing)합니다.

  #### 저널링 동작 방식
  1. 트랜잭션 시작: 작업 정보를 포함한 트랜잭션 시작 블록(TxB)을 저널에 기록.
  2. 데이터 및 메타데이터 기록: 갱신될 데이터와 메타데이터를 저널에 기록.
  3. 트랜잭션 종료: 트랜잭션 종료 블록(TxE)을 기록하며 작업 완료를 나타냄.
  4. 체크포인팅: 저널에 기록된 데이터를 실제 디스크 위치에 반영.

  #### 데이터 복구
  - 크래시 발생 시, 로그를 검사해 작업이 완전하게 기록되었는지 확인.
  - 로그에 따라 작업을 재실행(redo)하거나 중단된 작업을 무시.
  
  #### 성능 최적화
  - 쓰기 배리어: 디스크 쓰기의 순서를 보장하며, 데이터를 안전하게 기록.
  - 체크섬 사용: 트랜잭션의 무결성을 확인해 크래시 중 발생한 손상을 방지.
  - 효율적인 쓰기 전략: 트랜잭션 전체를 한 번에 기록해 성능을 개선.

<br>
</details>
