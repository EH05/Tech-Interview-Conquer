# 데드락(Deadlock, 교착상태)

---

## 면접 질문 예시

> "데드락의 정의와 발생 조건, 해결 방법에 대해 설명해 주세요”

---

<details>
  <summary><h2> 평가 요소 및 모범 답안</h2></summary>

  ### 1. 데드락의 정의
  - 포함내용
    * 데드락(교착상태) : 두 개 이상의 프로세스나 스레드가 서로 자원을 점유한 상태에서, 상대방이 가진 자원을 요청하며 무한히 기다리는 상태

  ### 2. 데드락의 발생 조건
  - 포함내용
    * 데드락의 발생 조건
      - 상호 배제: 한 번에 한 프로세스만 해당 자원을 사용할 수 있음
      - 점유 대기: 하나의 자원을 가진 상태에서 다른 자원을 기다림
      - 비선점: 다른 프로세스가 점유 중인 자원을 빼앗을 수 없음
      - 순환대기: 각 프로세스가 순환적으로 다음 프로세스가 요구하는 자원을 갖고 있음

  ### 3. 데드락의 해결 방법
  - 포함내용
    * 데드락의 해결 방법
      - 예방: 데드락의 발생 조건 4가지 중 하나라도 만족되지 않도록 함
      - 회피: 데드락이 발생할 가능성이 있는 상황을 미리 예측하고, 발생하지 않도록 동적으로 관리함
      - 팀지 및 복구: 데드락이 발생했는지 주기적으로 확인하고, 발견되면 해결함
      - 무시: 회복 과정에서 성능 저하가 심하게 발생한다면 무시함
  
  ### 3.모범 답안 예시

  > 데드락은 두 개 이상의 프로세스나 스레드가 서로 자원을 점유한 상태에서, 상대방이 가진 자원을 요청하며 무한히 기다리는 상태를 의미합니다.<br/>
    데드락이 발생하기 위해서는 상호 배제, 점유 대기, 비선점, 순환 대기라는 4가지 조건이 동시에 만족해야 합니다.<br/>
    **상호 배제**는 한 번에 한 프로세스만 해당 자원을 사용할 수 있음을 의미합니다.<br/>
    **점유 대기**는 하나의 자원을 가진 상태에서 다른 자원을 기다리는 것을 의미합니다.<br/>
    **비선점**은 다른 프로세스가 점유 중인 자원을 빼앗을 수 없음을 의미합니다.<br/>
    **순환 대기**는 각 프로세스가 순환적으로 다음 프로레스가 요구하는 자원을 가지고 있음을 의미합니다.<br/>
    데드락을 해결하는 방법으로 예방, 회피, 탐지 및 복구, 무시라는 4가지가 있습니다.<br/>
    **예방**은 데드락의 발생 조건 4가지 중 하나라도 만족되지 않도록 하는 것입니다.<br/>
    **회피**는 데드락이 발생할 가능성이 있는 상황을 미리 예측하고, 발생되지 않도록 동적으로 관리하는 것입니다.<br/>
    **탐지 및 복구**는 데드락이 발생했는지 주기적으로 확인하고, 발견되면 즉시 해결하는 것입니다.<br/>
    만약 데드락의 발생 빈도가 낮거나 복구 비용이 높을 경우, 이를 **무시**하고 운영하는 경우도 있습니다.
  
  ### 4. 심화 지식
  
  - 포함내용
    * 데드락의 해결 방법 - 장단점
      - 예방: 데드락을 원천적으로 방지할 수 있으나, 자원 낭비가 심함
      - 회피: 필요할 때만 자원을 할당하여 자원의 활용률을 높일 수 있으나, 매번 안전성을 검사해야 하므로 오버헤드가 발생함
      - 탐지 및 복구: 시스템을 유연하게 운영할 수 있으나, 탐지 과정에서 오버헤드가 발생할 수 있고 복구 시 데이터가 손실될 수 있음
     
    * 은행원 알고리즘
      - 데드락의 해결 방법 중 **회피**의 대표적인 기법
      - 프로세스가 자원을 요구할 때 시스템은 자원을 할당한 후에도 안정 상태로 남아있게 되는지를 사전에 검사하는 알고리즘
      - 발생하지 않으면 자원을 할당하고, 발생하면 다른 프로세스가 자원을 해제할 때까지 대기함
      - 안전상태: 시스템이 교착상태를 일으키지 않으면서 각 프로세스가 요구한 최대 요구량만큼 필요한 자원을 할당해 줄 수 있는 상태
      - 항상 안전 상태를 유지할 수 있다는 장점이 있으나 최대 자원 요구량을 미리 알아야 하고 항상 불안전 상태를 방지해야 하므로 자원 이용도가 낮음
     
    * 식사하는 철학자 문제
      > *다섯 명의 철학자가 원탁에 앉아 있고, 각자의 앞에는 스파게티가 있고 양옆에 포크가 하나씩 있다.
      > 그리고 각각의 철학자는 다른 철학자에게 말을 할 수 없다.
      > 이때 철학자가 스파게티를 먹기 위해서는 양 옆의 포크를 동시에 들어야 한다.*

      - 5명 모두 자신의 왼쪽 포크를 들고 있으므로 '점유대기'
      - 남이 포크를 뺏어주지 않음 '비선점'
      - 서로 오른쪽 포크를 놓기만을 기다림 '환형대기'
      - 각 포크에 대해 한 사람만 들 수 있음 '상호배제'

      방에 대한 입장 정원을 카운팅 세마포어로 설계해, 최대 4명만 들어온다면 방 안의 모든 사람들이 왼쪽 포크를 든다 하더라도 데드락이 발생하지 않음
