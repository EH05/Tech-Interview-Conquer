# 복합 데이터 타입

> - 기존의 데이터 베이스(관계형 모델)는 데이터의 중복을 피하기 위해서 원자성을 강조했다.   
> - 비원자적 데이터를 저장할 필요가 증가하였고 그에 따라 반구조형, 객체지향, 텍스트 및 공간 데이터등의 비원자적 데이터 타입이 등장하였다.
---

## 1. 반구조형 데이터

- 관계형 데이터 베이스 모델 : 고정된 수의 속성을 갖는 테이블
  - 속성을 추가하거나 삭제시 큰 비용 발생
- 스키마 변경이 자주 발생하는 도메인(EX. 웹 개발에서의 사용자 정보)에서 반구조형 데이터의 필요성 증가

<br>

### 1-1. 반구조형 데이터 모델 개관
  > 관계형 데이터 베이스가 복잡한 데이터를 저장하기 위해 확장되어온 과정 
1. 유연한 스키마
  - 와이드 칼럼 데이터 표현 : 각 튜플이 다른 종류의 속성 집합을 갖는 것을 허용함
  - 구현 방법 : 테이블이 많은 컬럼을 갖고 각 튜플은 있는 정보만 저장하고 없는 정보는 NULL로 데이터를 관리한다. (EX. 스파스 칼럼)

<br>

2. 다중값 데이터 타입
  - 속성값을 맵 ,집합, 다중 집합, 배열 형태로 저장하는 것
  - 비제1정규형(non first-normal-form, NFNF) 모델이라고도 부른다.

<br>

3. 중첩 데이터 타입
  - 데이터 타입이 계층 구조를 갖는것을 의미한다.
  - 대표적인 예시 : JavaScript Object Notation(JSON), Extensible Markup Language(XML)

<br>

4. 지식 표현
  - 인공지능 분야애서 인간 지식을 표현하기 위해 사용하는 데이터 타입, 객체와의 관꼐를 갖는 객체로 데이터를 모델링
  - 대표적인 예시 : Resource Description Format(RDF) 표현

<br>

### 1-2. JSON
  - 복잡한 데이터를 전달하거나 저장하는데 많이 사용되는 복합 데이터 타입의 텍스트 표현
  - 배열이나 객체 뿐만 아니라 기본 데이터 타입으로 정수, 실수, 문자열 등과 같은 타입도 지원
  - 기본적으로 키-맵과 동일하게 저장
  - 단점 : 
    1. 관계형 표현과 달리 JSON은 장황하여 동일한 데이터에 많은 저장 공간을 필요로 한다
    2. 검색을 위해서 CPU를 많이 사용한다
  
<br>

### 1-3. XML
  - 데이터 표현은 텍스트에서 어떤 정보를 표시하기 위해 홑화살괄호(<>)로 둘러쌓인 태그(tag)를 추가한다.
  - 관계형 스키마와 달리 새로운 태그가 쉽게 추가 가능하다.
  - 데이터의 의미를 추측할 수 있다는 점에서 데이터는 자체 문서화되었따.
  - 관계형에서는 불가능한 계층적 구조를 만들 수 있다.
  - 단점:
    1. 태그의 의미에 대한 이용자들 간의 사전 동의 필요
    2. XML 데이터 질의를 위한 XQuery는 사용처가 제한적임
  
<br>

### 1-4. RDF와 지식그래프
  > 개체 - 모델에 기반한 데이터 표준이다.
1. 트리플 표현
  - 형태 :
    1. (ID, attribute-name, value)
    2. (ID1, relationship-name, ID2)
  - 구성 :
    - 첫 번째 속성 : 주어
    - 두 번째 속성 : 술어
    - 세 번째 속성 : 목적어
  - 개체 타입 정보 : instance-of 관계를 통해 표현
  - 특징 :
    1. n-진 관계는 지원하지 않고 오직 이진 관계만을 지원한다.
    2. 새로운 속성이 객체에 쉽게 추가되며 새로운 타입의 관계로도 쉽게 생성될 수 있다.

<br>

2. RDF의 그래프 표현
  - 객체(타원)와 속성값(사각형)은 노드로 표현, 관계는 노드간 간선으로 표현
  - RDF 그래프 모델을 이용한 정보의 표현 지식 그래프
  - 응용 : 위키피디아에서의 데이터 출처 표기

<br>

3. SPARQL
  - RDF 데이터에 질의를 하기 위해 설계된 질의어.
  - ?cid라는 변수를 활용해서 원하는 데이터를 질의

<br>

4. N-진 관계의 표현
  - RDF는 기본적으로 이진관계만 모델링 가능
  - N진 관계 표현 방법
    1. 구체화(Concretization) : 추상적인 관계를 하나의 독립된 리소스로 만들어 구체적인 정보들을 부여하는 방식
    2. 쿼드(Quad) : RDF의 기본 삼중 구조에 네 번째 요소(컨텍스트)를 추가하는 방식

<br>

## 2. 객체 지향
  > 객체-관계 데이터 모델은 복합 데이터 타입 및 객체 지향을 포함하여 더 풍부한 타입을 제공함으로써 관계형 모델을 확장한 모델이다.   

<br>

### 2-1. 객체-관계 데이터베이스 시스템
  >  객체 지향의 특징이 데이터베이스 시스템에 접목된 방식
1. 사용자 정의 타입
  - SQL에 대한 객체 개념의 확장은 구조화된 사용자 정의 타입의 생성과 타입에 대한 참조, 타입을 포함한 테이블 생성을 가능하게 했다.
  - SQL 질의문 :
    - 사용자 정의 타입 생성 :
      > CREATE TYPE person   
      > (id VARCHAR(20) primary key,   
      >  name VARCHAR(20),   
      >  address VARCHAR(20))   
      > REF FROM(id);
    - 사용자 정의 타입을 참조하여 테이블 생성 :
      > CREATE TABLE people OF person;
    - 타입을 포함한 테이블 생성 :
      > CREATE TYPE interest AS TABLE(   
      >   topic VARCHAR(20),   
      >   degree_of_interest INT   
      >);   
      > CREATE TABLE users (
      >   id VARCHAR(20),   
      >  name VARCHAR(20),   
      >  interest interest);

<br>

2. 타입 상속
  - 기존에 선언된 객체를 상속하여 추가적인 정보 저장
  - 상속하는 상위 타입의 객체의 속성과 메서드를 상속받는다. 메서드는 재정의 가능하다 
  - SQL 질의문 :
    - 서브 타입 상속 : 
      > CREATE TYPE person   
      > (id VARCHAR(20) primary key,   
      >  name VARCHAR(20),   
      >  address VARCHAR(20))   
      > REF FROM(id);   
      > CREATE TYPE sutudent UNDER person   
      > (degree VARCHAR(20));   
      > CREATE TYPE teacher UNDER person   
      > (salary INTEGER);

<br>

3. 테이블 상속
  - 기존에 선언된 테이블을 상속하여 추가적인 정보 저장 가능하다
  - 상속한 테이블은 테이블 선언시 명시하지 않았던 상위 테이블의 속성도 저장 가능하다.
  - SQL 질의문 :
    - 선언된 테이블을 바탕으로 상속 :
      > CREATE TABLE students    
      > (degree VARCHAR(20))   
      > inherits people;

<br>

4. SQL에서 참조 타입
  - 참조 타입 선언을 포함하여 타입 정의가 가능하다.
  - ref()명령어를 활용, scope는 외래키 정의를 활성화하는 역할
  - ->나 DEREF()를 통해 참조타입에 접근 가능
  - SQL 질의문 :
    - 선언된 타입을 참조하여 타입을 정의 :
      > CREATE TYPE department(   
      > dept_name VARCHAR(20),   
      > head REF(person) SCOPE people);       
      > CREATE TABLE departments of department;
    - head의 이름과 주소 접근 , -> 활용 :
      > SELECT head -> name, head -> address   
      > from departments;
    - head의 이름과 주소 접근 , DEREF 활용 :
      > SELECT DEREF(head).name, DEREF(head).address   
      > from departments;

<br>

### 2-2. 객체 관계 매핑
  - 객체 관계 매핑(object-relational mapping, ORM) 시스템은 데이터베이스 튜플과 프로그래밍 언어의 객체 간의 매핑을 정의한다.
  - 장점 :
    1. 관계형 데이터베이스의 이점을 유지하며 객체 모델을 이용한 개발 가능
    2. 고수준의 코드를 사용해 여러 개의 데이터베이스를 사용 가능
    3. ORM은 데이터베이스들 간의 SQL 차이를 대신 해결해줌
  - 단점 :
    1. 복잡한 질의나 대량의 데이터베이스 갱신에서의 비효율
      > 해당 상황의 경우 직접 데이터베이스를 갱신하는 방법이 있음
  - 대표적 ORM : Hibernate Java, Django Python

<br>

## 3. 텍스트 데이터
  > 텍스트 데이터는 비구조화된 텍스트 데이터로 구성되어 있고, 텍스트 정보는 문서로 되어있다.

<br>

### 3-1. 키워드 질의
  - 질의에 있는 모든 키워드를 포함하는 문서를 검색하는 것
  - 형태
    - 단순한 형태 : 키워드를 포함하고 잇는 모든 문서 반환
    - 발전된 형태 : 문서의 적합도를 측정하여 순서대로 문서를 반환

<br>

### 3-2. 적합도 순위
  > 키워드를 포함하고 있는 문서의 갯수는 수도 없이 많을 수도 있고 이를 그냥 반환하는 것은 적절하지 않다. 적합도를 측정하여 우선순위를 매겨 반환할 필요가 있다.
1. TF-IDF를 이용한 순위화
  - 특정 단어가 문서 내에서 얼마나 중요한지를 측정하여, 검색 쿼리와 문서 간의 유사도를 계산
  - TF (Term Frequency): 문서 내에서 특정 단어가 얼마나 자주 등장하는지 측정
  - IDF (Inverse Document Frequency): 전체 문서 집합에서 특정 단어가 얼마나 희귀한지를 나타낸다. 자주 등장하는 단어는 중요도가 낮아지도록 조정
  
<br>

2. 하이퍼링크를 이용한 순위화
  - 웹 페이지 간의 연결(하이퍼링크)을 이용하여 각 페이지의 '중요도'나 '신뢰도'를 평가
  - 페이지의 권위: 다른 페이지들이 링크를 걸어주면, 그 페이지가 중요한 정보원일 가능성이 높다고 가정
  - 예시 : 구글의 PageRank 알고리즘

<br>

### 3-3. 검색 유효성 측정
  - 평가 지표 : 정밀도, 재현율
    - 정밀도 : 질의에 대해서 검색된 문서들 중 실제로 적합한 문서의 비율
    - 재현율 : 적합한 모든 문서 중에서 검색된 적합한 문서의 비율
    
<br>

### 3-4. 구조화 데이터 및 지식 그래프에 대한 키워드 질의
  - 키워드 질의는 SQL를 모르는 사람들에게도 질의를 할수 있게 도와준다.
  - 오늘 날 웹 기반 검색 엔진은 그래프를 이용해 데이터를 표현하고 그래프에 대하여 키워드 질의를 하는 방식을 만들었다.
  - 키워드 질의는 완전하게 정의되지 않았기 때문에 순위화가 필수적이다.

<br>

## 4. 공간 데이터
  > 공간 데이터 저장은 데이터베이스에서 중요한 요소이고 그중 지리정보 데이터와 기하학적 데이터에 대한 저장은 특히 중요하다.

<br>

### 4-1. 기하학적 정보의 표현
  - 선분 : 양 끝점의 좌표로 표현
  - 꺾은선 : 여러개의 선분을 이은것 -> 각좌표를 저장
  - 곡선 : 호의 연속 or 수많은 선분
  - 다각형 : 꼭지점의 좌표 리스트 or 삼각형의 집합으로 분할
  - 3차원 공간 : z좌표 추가

<br>

### 4-2. 디자인 데이터베이스
  - 도면을 그리는 CAD는 작업후 저장을 하는 과정과 저장한 데이터를 불러오는 과정에서 큰 소요 시간을 갖음 이를 해결하기 위해서 디자인 데이터베이스가 출시됨
  - 와이어 프레임 모델 : 표면을 선분, 삼각형, 사각형등 단순한 객체로 표현

<br>

### 4-3. 지리정보 데이터
1. 지리정보 데이터 응용
  - 지도 서비스, 네비게이션 서비스와 같은 1차적 응용부터, 유통망 분석등 다양하게 활용된다.

<br>

2. 지리정보 데이터의 표현
  - 지리정보 데이터 타입:
    - 래스터 데이터(= 타일) : 2차원 이상에서 비트맵이나 픽셀 맵으로 구성된 데이터(EX. 위성 이미지), 다른 줌 수준에 따라 데이터를 보여 줄 수 있도록 하기 위해서 타일의 집합이 각기 다른 줌 수준에 따라 생성
    - 벡터 데이터 : 2차원은 점,선, 다각형으로 3차원은 원통, 구 등과 같은 기본적인 기하학적인 객체로 표현
  - 응용 표현 : 여러개의 지리 정보 데이터를 겹쳐서(overlay) 보여준다.

<br>

### 4-4. 공간 질의
  - 영역 질의 : 특정 영역 안에 부분적으로 혹은 완전히 위치한 객체를 찾는다. (EX. 특정 영역안에 있는 모든 소매점 찾기)
  - 근접 질의 : 특정 위치에 근접해 있는 객체를 찾기. (EX. 가까운 주유소 찾기)
  - 공간 그래프 질의 : 도로 지도와 같은 공간 그래프에 기반한 정보를 찾는데 사용 (EX. 두 위치 간의 최소 거리를 찾는 질의)
  - 공간 조인 : 영역의 겹침을 계산하는 질의 (EX. 일식집중 한끼가 만원이하의 식당 찾기)